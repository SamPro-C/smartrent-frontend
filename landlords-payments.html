<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SmartRent - Landlord Dashboard</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
  <style>
    :root {
      --primary: #3498db;
      --primary-dark: #2980b9;
      --secondary: #2ecc71;
      --danger: #e74c3c;
      --warning: #f39c12;
      --info: #1abc9c;
      --dark: #34495e;
      --light: #ecf0f1;
      --gray: #95a5a6;
      --white: #ffffff;
      --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background-color: #f5f7fa;
    }
    
    .navbar {
      background-color: var(--white);
      box-shadow: var(--shadow);
      padding: 0.8rem 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
    }
    
    .logo {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--primary);
      display: flex;
      align-items: center;
    }
    
    .logo i {
      margin-right: 0.5rem;
    }
    
    .nav-links {
      display: flex;
      list-style: none;
    }
    
    .nav-links li {
      margin: 0 0.8rem;
    }
    
    .nav-links a {
      text-decoration: none;
      color: var(--dark);
      font-weight: 500;
      padding: 0.5rem 0.8rem;
      border-radius: 4px;
      transition: all 0.3s;
    }
    
    .nav-links a:hover, .nav-links a.active {
      background-color: var(--primary);
      color: var(--white);
    }
    
    .nav-right {
      display: flex;
      align-items: center;
    }
    
    .notification {
      position: relative;
      margin-right: 1.5rem;
      cursor: pointer;
    }
    
    .notification-count {
      position: absolute;
      top: -5px;
      right: -5px;
      background-color: var(--danger);
      color: white;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      font-size: 0.7rem;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .profile {
      display: flex;
      align-items: center;
      cursor: pointer;
      position: relative;
    }
    
    .profile img {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 0.5rem;
      object-fit: cover;
    }
    
    .hamburger {
      display: none;
      flex-direction: column;
      cursor: pointer;
    }
    
    .hamburger span {
      width: 25px;
      height: 3px;
      background-color: var(--dark);
      margin: 2px 0;
      transition: all 0.3s;
    }

    .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header Styles */
        header {
            background-color: #fff;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            padding: 16px 0;
        }

        .header-content h1 {
            font-size: 24px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 4px;
        }

        .header-content p {
            color: #718096;
            font-size: 16px;
        }

        /* Main Content Styles */
        main {
            padding: 30px 0;
        }

        /* Search and Filters */
        .search-filters {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 16px;
            margin-bottom: 24px;
        }

        .search-row {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-bottom: 16px;
        }

        @media (min-width: 768px) {
            .search-row {
                flex-direction: row;
                align-items: center;
            }
        }

        .search-container {
            position: relative;
            flex-grow: 1;
        }

        .search-container input {
            width: 100%;
            padding: 10px 16px 10px 40px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            background-color: #f8fafc;
            font-size: 14px;
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #a0aec0;
        }

        .filters-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        select {
            padding: 10px 16px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            background-color: #f8fafc;
            font-size: 14px;
            color: #4a5568;
        }

        /* Action Buttons */
        .actions-row {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            margin-bottom: 24px;
            gap: 16px;
        }

        .buttons-group {
            display: flex;
            gap: 8px;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            padding: 10px 16px;
            border-radius: 8px;
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
            border: none;
            transition: background-color 0.2s;
        }

        .btn-primary {
            background-color: #3182ce;
            color: white;
        }

        .btn-primary:hover {
            background-color: #2c5282;
        }

        .btn-success {
            background-color: #38a169;
            color: white;
        }

        .btn-success:hover {
            background-color: #276749;
        }

        .btn-icon {
            margin-right: 8px;
        }

        .results-count {
            display: flex;
            align-items: center;
            color: #718096;
            font-size: 14px;
        }

        /* Table Styles */
        .table-container {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            margin-bottom: 32px;
        }

        .table-scroll {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background-color: #f8fafc;
            color: #718096;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 12px 16px;
            text-align: left;
        }

        td {
            padding: 16px;
            border-top: 1px solid #edf2f7;
            font-size: 14px;
        }

        tr:hover {
            background-color: #f8fafc;
        }

        .tenant-name {
            font-weight: 500;
            color: #2d3748;
        }

        .tenant-id {
            color: #718096;
            font-size: 13px;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 9999px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-paid {
            background-color: #c6f6d5;
            color: #276749;
        }

        .status-unpaid {
            background-color: #fed7d7;
            color: #9b2c2c;
        }

        .action-link {
            color: #3182ce;
            text-decoration: none;
            margin-right: 8px;
            font-size: 13px;
        }

        .action-link:hover {
            text-decoration: underline;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            margin-bottom: 32px;
        }

        @media (min-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .stats-card {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 24px;
            position: relative;
        }

        .stats-card.border-green {
            border-left: 4px solid #38a169;
        }

        .stats-card.border-red {
            border-left: 4px solid #e53e3e;
        }

        .stats-card.border-blue {
            border-left: 4px solid #3182ce;
        }

        .stats-title {
            font-size: 16px;
            font-weight: 500;
            color: #2d3748;
        }

        .stats-value {
            font-size: 24px;
            font-weight: 700;
            margin: 8px 0 4px;
        }

        .stats-subtitle {
            font-size: 13px;
            color: #718096;
        }

        /* Recent Activity */
        .activity-section {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            padding: 24px;
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 18px;
            font-weight: 500;
            color: #2d3748;
            margin-bottom: 16px;
        }

        .activity-list {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .activity-item {
            display: flex;
            align-items: flex-start;
        }

        .activity-icon {
            flex-shrink: 0;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            margin-right: 12px;
        }

        .activity-icon.green {
            background-color: #c6f6d5;
            color: #38a169;
        }

        .activity-icon.blue {
            background-color: #bee3f8;
            color: #3182ce;
        }

        .activity-content p {
            font-size: 14px;
            font-weight: 500;
            color: #4a5568;
            margin-bottom: 4px;
        }

        .activity-time {
            font-size: 12px;
            color: #a0aec0;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            display: none;
        }

        .modal {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.08);
            width: 100%;
            max-width: 700px;
            padding: 24px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 700;
            color: #2d3748;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            color: #a0aec0;
            cursor: pointer;
        }

        .modal-form {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
        }

        @media (min-width: 768px) {
            .modal-form {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .form-group {
            margin-bottom: 0;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 500;
            color: #4a5568;
            margin-bottom: 4px;
        }

        .form-control {
            width: 100%;
            padding: 10px 12px;
            border-radius: 6px;
            border: 1px solid #e2e8f0;
            background-color: #f8fafc;
            font-size: 14px;
        }

        .form-group-full {
            grid-column: span 1;
        }

        @media (min-width: 768px) {
            .form-group-full {
                grid-column: span 2;
            }
        }

        .file-upload {
            border: 2px dashed #e2e8f0;
            border-radius: 6px;
            padding: 20px;
            text-align: center;
        }

        .file-upload svg {
            width: 48px;
            height: 48px;
            margin: 0 auto 16px;
            display: block;
            color: #a0aec0;
        }

        .file-upload-text {
            font-size: 14px;
            color: #718096;
            margin-bottom: 8px;
        }

        .file-upload-label {
            color: #3182ce;
            font-weight: 500;
            cursor: pointer;
        }

        .file-upload-hint {
            font-size: 12px;
            color: #a0aec0;
        }

        .form-actions {
            grid-column: span 1;
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            padding-top: 16px;
        }

        @media (min-width: 768px) {
            .form-actions {
                grid-column: span 2;
            }
        }

        .btn-secondary {
            background-color: #f8fafc;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background-color: #edf2f7;
        }
   
    
    @media (max-width: 992px) {
      .charts-container {
        grid-template-columns: 1fr;
      }
    }
    
    @media (max-width: 768px) {
      .nav-links, .nav-right {
        display: none;
      }
      
      .nav-links.active {
        display: flex;
        flex-direction: column;
        position: absolute;
        top: 70px;
        left: 0;
        right: 0;
        background-color: var(--white);
        box-shadow: var(--shadow);
        padding: 1rem;
      }
      
      .nav-links.active li {
        margin: 0.8rem 0;
      }
      
      .hamburger {
        display: flex;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Top Navbar -->
  <nav class="navbar">
    <div class="logo">
      <i class="fas fa-building"></i>
      <span>SmartRent</span>
    </div>
    
   <ul class="nav-links">
      <li><a href="landlords-dashboard.html" class="active">Dashboard</a></li>
      <li><a href="landlords-apartments.html">Apartments</a></li>
      <li><a href="landlords-tenants.html">Tenants</a></li>
      <li><a href="landlords-workers.html" >Workers</a></li>
      <li><a href="landlords-payments.html" class="active">Payments</a></li>
      <li><a href="landlords-reports.html">Reports</a></li>
      <li><a href="landlords-notifications.html">Notifications</a></li>
      <li><a href="landlords-settings.html">Settings</a></li>
    </ul>
    
    <div class="nav-right">
      <div class="notification">
        <i class="fas fa-bell"></i>
        <span class="notification-count">3</span>
      </div>
      
      <div class="profile">
        <img src="/api/placeholder/40/40" alt="Profile Picture">
        <span>John Doe</span>
      </div>
    </div>
    
    <div class="hamburger">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </nav>

   <!-- Header -->
   <header>
    <div class="container header-content">
        <h1>Payments Management</h1>
        <p>Track and manage all tenant payments</p>
    </div>
</header>

<!-- Main Content -->
<main>
    <div class="container">
        <!-- Search and Filters -->
        <div class="search-filters">
            <div class="search-row">
                <!-- Search -->
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search by tenant name, ID or M-Pesa code...">
                    <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                </div>
                
                <!-- Filters -->
                <div class="filters-container">
                    <select id="apartmentFilter">
                        <option value="all">All Apartments</option>
                        <option value="Sunshine Apartments">Sunshine Apartments</option>
                        <option value="Riverside Flats">Riverside Flats</option>
                        <option value="City Heights">City Heights</option>
                    </select>
                    
                    <select id="statusFilter">
                        <option value="all">All Statuses</option>
                        <option value="paid">Paid</option>
                        <option value="unpaid">Unpaid</option>
                    </select>
                    
                    <select id="dateFilter">
                        <option value="current-month">Current Month</option>
                        <option value="last-month">Last Month</option>
                        <option value="last-3-months">Last 3 Months</option>
                        <option value="custom">Custom Range</option>
                    </select>
                    
                    <select id="methodFilter">
                        <option value="all">All Payment Methods</option>
                        <option value="mpesa">M-Pesa</option>
                        <option value="bank">Bank Transfer</option>
                        <option value="cash">Cash</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- Action Buttons -->
        <div class="actions-row">
            <div class="buttons-group">
                <button class="btn btn-primary" id="addPaymentBtn">
                    <svg class="btn-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="8" x2="12" y2="16"></line>
                        <line x1="8" y1="12" x2="16" y2="12"></line>
                    </svg>
                    Add Payment
                </button>
                
                <button class="btn btn-success">
                    <svg class="btn-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="7 10 12 15 17 10"></polyline>
                        <line x1="12" y1="15" x2="12" y2="3"></line>
                    </svg>
                    Download Report
                </button>
            </div>
            
            <div class="results-count">
                <svg width="18" height="18" class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                </svg>
                <span>Showing 5 of 5 payments</span>
            </div>
        </div>
        
        <!-- Payments Table -->
        <div class="table-container">
            <div class="table-scroll">
                <table id="paymentsTable">
                    <thead>
                        <tr>
                            <th>Tenant</th>
                            <th>Apartment Details</th>
                            <th>Amount</th>
                            <th>Payment Details</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Table rows will be inserted here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stats-card border-green">
                <h3 class="stats-title">Total Collected</h3>
                <p class="stats-value">KES 57,000</p>
                <p class="stats-subtitle">for current period</p>
            </div>
            
            <div class="stats-card border-red">
                <h3 class="stats-title">Outstanding Amount</h3>
                <p class="stats-value">KES 43,000</p>
                <p class="stats-subtitle">from 2 tenants</p>
            </div>
            
            <div class="stats-card border-blue">
                <h3 class="stats-title">Collection Rate</h3>
                <p class="stats-value">57%</p>
                <p class="stats-subtitle">3 of 5 tenants paid</p>
            </div>
        </div>
        
        <!-- Recent Activity -->
        <div class="activity-section">
            <h2 class="section-title">Recent Payment Activity</h2>
            <div class="activity-list">
                <div class="activity-item">
                    <div class="activity-icon green">✓</div>
                    <div class="activity-content">
                        <p>Sarah Williams made a payment of KES 22,000 via M-Pesa</p>
                        <span class="activity-time">3 hours ago</span>
                    </div>
                </div>
                
                <div class="activity-item">
                    <div class="activity-icon blue">↓</div>
                    <div class="activity-content">
                        <p>You sent payment reminders to 2 tenants with outstanding balances</p>
                        <span class="activity-time">Yesterday at 4:30 PM</span>
                    </div>
                </div>
                
                <div class="activity-item">
                    <div class="activity-icon green">✓</div>
                    <div class="activity-content">
                        <p>John Doe made a payment of KES 15,000 via M-Pesa</p>
                        <span class="activity-time">April 10, 2025</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>

<!-- Add Payment Modal -->
<div class="modal-overlay" id="addPaymentModal">
    <div class="modal">
        <div class="modal-header">
            <h2 class="modal-title">Add Payment Manually</h2>
            <button class="modal-close" id="closeModal">&times;</button>
        </div>
        
        <form class="modal-form" id="paymentForm">
            <div class="form-group">
                <label class="form-label" for="tenant">Tenant*</label>
                <select class="form-control" id="tenant" required>
                    <option value="">Select Tenant</option>
                    <option value="1">John Doe (T-2025001)</option>
                    <option value="3">Michael Johnson (T-2025003)</option>
                    <option value="5">David Brown (T-2025005)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="amount">Amount (KES)*</label>
                <input type="number" class="form-control" id="amount" required>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="paymentMethod">Payment Method*</label>
                <select class="form-control" id="paymentMethod" required>
                    <option value="">Select Method</option>
                    <option value="mpesa">M-Pesa</option>
                    <option value="bank">Bank Transfer</option>
                    <option value="cash">Cash</option>
                </select>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="paymentDate">Payment Date*</label>
                <input type="date" class="form-control" id="paymentDate" required>
            </div>
            
            <div class="form-group">
                <label class="form-label" for="mpesaCode">Transaction Code (M-Pesa)</label>
                <input type="text" class="form-control" id="mpesaCode">
            </div>
            
            <div class="form-group">
                <label class="form-label" for="referenceNumber">Reference Number (Bank)</label>
                <input type="text" class="form-control" id="referenceNumber">
            </div>
            
            <div class="form-group-full">
                <label class="form-label">Upload Receipt/Screenshot (optional)</label>
                <div class="file-upload">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                        <polyline points="17 8 12 3 7 8"></polyline>
                        <line x1="12" y1="3" x2="12" y2="15"></line>
                    </svg>
                    <p class="file-upload-text">
                        <label class="file-upload-label">
                            Upload a file
                            <input type="file" id="receiptFile" style="display: none;">
                        </label>
                        or drag and drop
                    </p>
                    <p class="file-upload-hint">PNG, JPG, PDF up to 5MB</p>
                </div>
            </div>
            
            <div class="form-group-full">
                <label class="form-label" for="notes">Notes (optional)</label>
                <textarea class="form-control" id="notes" rows="3"></textarea>
            </div>
            
            <div class="form-actions">
                <button type="button" class="btn btn-secondary" id="cancelBtn">Cancel</button>
                <button type="submit" class="btn btn-primary">Save Payment</button>
            </div>
        </form>
    </div>
</div>
 
  
  <script>
    // Toggle mobile menu
document.querySelector('.hamburger').addEventListener('click', function() {
  document.querySelector('.nav-links').classList.toggle('active');
});

// Sample payment data
const paymentData = [
    { 
        id: 1, 
        tenantName: 'John Doe', 
        tenantId: 'T-2025001', 
        amount: 15000, 
        datePaid: '2025-04-10', 
        apartment: 'Sunshine Apartments', 
        unit: 'A', 
        room: '101', 
        status: 'paid', 
        paymentMethod: 'mpesa', 
        mpesaCode: 'PXC78945TY', 
        receiptImage: '/placeholder.jpg' 
    },
    { 
        id: 2, 
        tenantName: 'Jane Smith', 
        tenantId: 'T-2025002', 
        amount: 20000, 
        datePaid: '2025-04-05', 
        apartment: 'Sunshine Apartments', 
        unit: 'B', 
        room: '205', 
        status: 'paid', 
        paymentMethod: 'bank', 
        referenceNo: 'BNK5678901' 
    },
    { 
        id: 3, 
        tenantName: 'Michael Johnson', 
        tenantId: 'T-2025003', 
        amount: 18000, 
        datePaid: null, 
        apartment: 'Riverside Flats', 
        unit: 'C', 
        room: '302', 
        status: 'unpaid', 
        paymentMethod: null 
    },
    { 
        id: 4, 
        tenantName: 'Sarah Williams', 
        tenantId: 'T-2025004', 
        amount: 22000, 
        datePaid: '2025-04-12', 
        apartment: 'Riverside Flats', 
        unit: 'A', 
        room: '105', 
        status: 'paid', 
        paymentMethod: 'mpesa', 
        mpesaCode: 'PXD12385TY', 
        receiptImage: '/placeholder.jpg' 
    },
    { 
        id: 5, 
        tenantName: 'David Brown', 
        tenantId: 'T-2025005', 
        amount: 25000, 
        datePaid: null, 
        apartment: 'City Heights', 
        unit: 'D', 
        room: '410', 
        status: 'unpaid', 
        paymentMethod: null 
    },
];

// DOM Elements
const paymentsTable = document.getElementById('paymentsTable');
const searchInput = document.getElementById('searchInput');
const apartmentFilter = document.getElementById('apartmentFilter');
const statusFilter = document.getElementById('statusFilter');
const dateFilter = document.getElementById('dateFilter');
const methodFilter = document.getElementById('methodFilter');
const addPaymentBtn = document.getElementById('addPaymentBtn');
const addPaymentModal = document.getElementById('addPaymentModal');
const closeModal = document.getElementById('closeModal');
const cancelBtn = document.getElementById('cancelBtn');
const paymentForm = document.getElementById('paymentForm');

// Render payments table
function renderPaymentsTable(payments) {
    const tableBody = paymentsTable.querySelector('tbody');
    tableBody.innerHTML = '';
    
    if (payments.length === 0) {
        const emptyRow = document.createElement('tr');
        emptyRow.innerHTML = `
            <td colspan="6" style="text-align: center;">No payments found matching your filters</td>
        `;
        tableBody.appendChild(emptyRow);
        return;
    }
    
    payments.forEach(payment => {
        const row = document.createElement('tr');
        
        // Tenant column
        const tenantCell = document.createElement('td');
        tenantCell.innerHTML = `
            <div class="tenant-name">${payment.tenantName}</div>
            <div class="tenant-id">ID: ${payment.tenantId}</div>
        `;
        
        // Apartment details column
        const apartmentCell = document.createElement('td');
        apartmentCell.innerHTML = `
            <div>${payment.apartment}</div>
            <div class="tenant-id">Unit ${payment.unit}, Room ${payment.room}</div>
        `;
        
        // Amount column
        const amountCell = document.createElement('td');
        amountCell.innerHTML = `
            <div class="tenant-name">KES ${payment.amount.toLocaleString()}</div>
        `;
        
        // Payment details column
        const detailsCell = document.createElement('td');
        if (payment.status === 'paid') {
            let methodText = '';
            if (payment.paymentMethod === 'mpesa') methodText = 'M-Pesa';
            else if (payment.paymentMethod === 'bank') methodText = 'Bank Transfer';
            else if (payment.paymentMethod === 'cash') methodText = 'Cash';
            
            detailsCell.innerHTML = `
                <div>Date: ${payment.datePaid}</div>
                <div class="tenant-id">Method: ${methodText}</div>
            `;
            
            if (payment.mpesaCode) {
                detailsCell.innerHTML += `<div class="tenant-id">M-Pesa Code: ${payment.mpesaCode}</div>`;
            }
            
            if (payment.referenceNo) {
                detailsCell.innerHTML += `<div class="tenant-id">Reference: ${payment.referenceNo}</div>`;
            }
        } else {
            detailsCell.innerHTML = `<div class="tenant-id">Not yet paid</div>`;
        }
        
        // Status column
        const statusCell = document.createElement('td');
        statusCell.innerHTML = `
            <span class="status-badge ${payment.status === 'paid' ? 'status-paid' : 'status-unpaid'}">
                ${payment.status === 'paid' ? 'Paid' : 'Unpaid'}
            </span>
        `;
        
        // Actions column
        const actionsCell = document.createElement('td');
        if (payment.status === 'paid') {
            actionsCell.innerHTML = `
                <a href="#" class="action-link view-receipt" data-id="${payment.id}">Receipt</a>
                <a href="#" class="action-link send-receipt" data-id="${payment.id}">Send Receipt</a>
            `;
        } else {
            actionsCell.innerHTML = `
                <a href="#" class="action-link add-payment" data-id="${payment.id}">Record Payment</a>
                <a href="#" class="action-link send-reminder" data-id="${payment.id}">Send Reminder</a>
            `;
        }
        
        // Append all cells to the row
        row.appendChild(tenantCell);
        row.appendChild(apartmentCell);
        row.appendChild(amountCell);
        row.appendChild(detailsCell);
        row.appendChild(statusCell);
        row.appendChild(actionsCell);
        
        // Append row to table body
        tableBody.appendChild(row);
    });
}

// Filter payments
function filterPayments() {
    const searchTerm = searchInput.value.toLowerCase();
    const apartmentValue = apartmentFilter.value;
    const statusValue = statusFilter.value;
    const methodValue = methodFilter.value;
    
    const filteredPayments = paymentData.filter(payment => {
        // Search term filter
        const matchesSearch = 
            payment.tenantName.toLowerCase().includes(searchTerm) || 
            payment.tenantId.toLowerCase().includes(searchTerm) || 
            (payment.mpesaCode && payment.mpesaCode.toLowerCase().includes(searchTerm));
            
        // Apartment filter
        const matchesApartment = apartmentValue === 'all' || payment.apartment === apartmentValue;
        
        // Status filter
        const matchesStatus = statusValue === 'all' || payment.status === statusValue;
        
        // Method filter
        const matchesMethod = methodValue === 'all' || payment.paymentMethod === methodValue;
        
        return matchesSearch && matchesApartment && matchesStatus && matchesMethod;
    });
    
    // Update results count text
    document.querySelector('.results-count span').textContent = `Showing ${filteredPayments.length} of ${paymentData.length} payments`;
    
    // Render filtered payments
    renderPaymentsTable(filteredPayments);
}

// Event listeners for filters
searchInput.addEventListener('input', filterPayments);
apartmentFilter.addEventListener('change', filterPayments);
statusFilter.addEventListener('change', filterPayments);
dateFilter.addEventListener('change', filterPayments);
methodFilter.addEventListener('change', filterPayments);

// Modal functionality
function openModal() {
    addPaymentModal.style.display = 'flex';
    document.body.style.overflow = 'hidden'; // Prevent scrolling when modal is open
}

function closeModal() {
    addPaymentModal.style.display = 'none';
    document.body.style.overflow = 'auto'; // Re-enable scrolling
    paymentForm.reset(); // Reset form fields
}

// Add event listeners for modal
addPaymentBtn.addEventListener('click', openModal);
closeModal.addEventListener('click', closeModal);
cancelBtn.addEventListener('click', closeModal);

// Close modal if clicked outside
addPaymentModal.addEventListener('click', function(event) {
    if (event.target === addPaymentModal) {
        closeModal();
    }
});

// Handle form submission
paymentForm.addEventListener('submit', function(event) {
    event.preventDefault();
    
    // Get form values
    const tenantId = document.getElementById('tenant').value;
    const amount = parseFloat(document.getElementById('amount').value);
    const paymentMethod = document.getElementById('paymentMethod').value;
    const paymentDate = document.getElementById('paymentDate').value;
    const mpesaCode = document.getElementById('mpesaCode').value;
    const referenceNumber = document.getElementById('referenceNumber').value;
    const notes = document.getElementById('notes').value;
    
    // Here you would typically send this data to a server
    console.log('Payment submitted:', {
        tenantId,
        amount,
        paymentMethod,
        paymentDate,
        mpesaCode,
        referenceNumber,
        notes
    });
    
    // In a real app, you'd update the payments list with the new payment
    // For demo purposes, we'll just show a simple alert
    alert('Payment recorded successfully!');
    
    closeModal();
});

// Table row action handlers
document.addEventListener('click', function(event) {
    // View receipt handler
    if (event.target.classList.contains('view-receipt')) {
        event.preventDefault();
        const paymentId = event.target.getAttribute('data-id');
        alert(`Viewing receipt for payment ID: ${paymentId}`);
    }
    
    // Send receipt handler
    if (event.target.classList.contains('send-receipt')) {
        event.preventDefault();
        const paymentId = event.target.getAttribute('data-id');
        alert(`Receipt sent for payment ID: ${paymentId}`);
    }
    
    // Record payment handler
    if (event.target.classList.contains('add-payment')) {
        event.preventDefault();
        const paymentId = event.target.getAttribute('data-id');
        openModal();
        // In a real app, you would pre-fill the form with the tenant information
        document.getElementById('tenant').value = paymentId;
    }
    
    // Send reminder handler
    if (event.target.classList.contains('send-reminder')) {
        event.preventDefault();
        const paymentId = event.target.getAttribute('data-id');
        alert(`Payment reminder sent for ID: ${paymentId}`);
    }
});

// Dynamic payment method fields
document.getElementById('paymentMethod').addEventListener('change', function() {
    const method = this.value;
    const mpesaField = document.getElementById('mpesaCode').parentElement;
    const bankField = document.getElementById('referenceNumber').parentElement;
    
    // Show/hide relevant fields based on payment method
    if (method === 'mpesa') {
        mpesaField.style.display = 'block';
        bankField.style.display = 'none';
    } else if (method === 'bank') {
        mpesaField.style.display = 'none';
        bankField.style.display = 'block';
    } else {
        mpesaField.style.display = 'none';
        bankField.style.display = 'none';
    }
});

// File upload preview
document.getElementById('receiptFile').addEventListener('change', function(event) {
    const file = event.target.files[0];
    if (file) {
        const fileSize = (file.size / 1024 / 1024).toFixed(2); // Convert to MB
        const fileUploadText = document.querySelector('.file-upload-text');
        fileUploadText.textContent = `Selected: ${file.name} (${fileSize} MB)`;
    }
});

// Initialize table on page load
window.addEventListener('DOMContentLoaded', function() {
    renderPaymentsTable(paymentData);
    
    // Set default date to today for payment form
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('paymentDate').value = today;
});
    
  </script>
</body>
</html>
